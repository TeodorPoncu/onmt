{".class": "MypyFile", "_fullname": "opennmt.optimizers.mixed_precision_wrapper", "is_partial_stub_package": false, "is_stub": false, "names": {".class": "SymbolTable", "AutomaticLossScaler": {".class": "SymbolTableNode", "kind": "Gdef", "node": {".class": "TypeInfo", "_promote": null, "abstract_attributes": [], "bases": ["builtins.object"], "declared_metaclass": null, "defn": {".class": "ClassDef", "fullname": "opennmt.optimizers.mixed_precision_wrapper.AutomaticLossScaler", "name": "AutomaticLossScaler", "type_vars": []}, "flags": [], "fullname": "opennmt.optimizers.mixed_precision_wrapper.AutomaticLossScaler", "metaclass_type": null, "metadata": {}, "module_name": "opennmt.optimizers.mixed_precision_wrapper", "mro": ["opennmt.optimizers.mixed_precision_wrapper.AutomaticLossScaler", "builtins.object"], "names": {".class": "SymbolTable", "SUPPORTED_ALGOS": {".class": "SymbolTableNode", "kind": "Mdef", "node": {".class": "Var", "flags": ["is_initialized_in_class"], "fullname": "opennmt.optimizers.mixed_precision_wrapper.AutomaticLossScaler.SUPPORTED_ALGOS", "name": "SUPPORTED_ALGOS", "type": {".class": "Instance", "args": ["builtins.str"], "type_ref": "builtins.list"}}}, "__init__": {".class": "SymbolTableNode", "kind": "Mdef", "node": {".class": "FuncDef", "arg_kinds": [0, 1, 1], "arg_names": ["self", "algorithm", "params"], "flags": [], "fullname": "opennmt.optimizers.mixed_precision_wrapper.AutomaticLossScaler.__init__", "name": "__init__", "type": null}}, "check_grads": {".class": "SymbolTableNode", "kind": "Mdef", "node": {".class": "Decorator", "func": {".class": "FuncDef", "arg_kinds": [0], "arg_names": ["grads_and_vars"], "flags": ["is_static", "is_decorated"], "fullname": "opennmt.optimizers.mixed_precision_wrapper.AutomaticLossScaler.check_grads", "name": "check_grads", "type": null}, "is_overload": false, "var": {".class": "Var", "flags": ["is_initialized_in_class", "is_staticmethod"], "fullname": null, "name": "check_grads", "type": {".class": "CallableType", "arg_kinds": [0], "arg_names": ["grads_and_vars"], "arg_types": [{".class": "AnyType", "missing_import_name": null, "source_any": null, "type_of_any": 1}], "bound_args": [], "def_extras": {}, "fallback": "builtins.function", "implicit": true, "is_ellipsis_args": false, "name": "check_grads of AutomaticLossScaler", "ret_type": {".class": "AnyType", "missing_import_name": null, "source_any": null, "type_of_any": 1}, "variables": []}}}}, "loss_scale": {".class": "SymbolTableNode", "kind": "Mdef", "node": {".class": "Decorator", "func": {".class": "FuncDef", "arg_kinds": [0], "arg_names": ["self"], "flags": ["is_property", "is_decorated"], "fullname": "opennmt.optimizers.mixed_precision_wrapper.AutomaticLossScaler.loss_scale", "name": "loss_scale", "type": null}, "is_overload": false, "var": {".class": "Var", "flags": ["is_initialized_in_class", "is_property"], "fullname": null, "name": "loss_scale", "type": {".class": "CallableType", "arg_kinds": [0], "arg_names": ["self"], "arg_types": [{".class": "AnyType", "missing_import_name": null, "source_any": null, "type_of_any": 1}], "bound_args": [], "def_extras": {}, "fallback": "builtins.function", "implicit": true, "is_ellipsis_args": false, "name": "loss_scale of AutomaticLossScaler", "ret_type": {".class": "AnyType", "missing_import_name": null, "source_any": null, "type_of_any": 1}, "variables": []}}}}, "scaler": {".class": "SymbolTableNode", "implicit": true, "kind": "Mdef", "node": {".class": "Var", "flags": [], "fullname": "opennmt.optimizers.mixed_precision_wrapper.AutomaticLossScaler.scaler", "name": "scaler", "type": {".class": "AnyType", "missing_import_name": null, "source_any": null, "type_of_any": 1}}}, "update_op": {".class": "SymbolTableNode", "kind": "Mdef", "node": {".class": "FuncDef", "arg_kinds": [0, 0, 0], "arg_names": ["self", "has_nan", "amax"], "flags": [], "fullname": "opennmt.optimizers.mixed_precision_wrapper.AutomaticLossScaler.update_op", "name": "update_op", "type": null}}}, "tuple_type": null, "type_vars": [], "typeddict_type": null}}, "BackoffScaler": {".class": "SymbolTableNode", "kind": "Gdef", "node": {".class": "TypeInfo", "_promote": null, "abstract_attributes": [], "bases": ["builtins.object"], "declared_metaclass": null, "defn": {".class": "ClassDef", "fullname": "opennmt.optimizers.mixed_precision_wrapper.BackoffScaler", "name": "BackoffScaler", "type_vars": []}, "flags": [], "fullname": "opennmt.optimizers.mixed_precision_wrapper.BackoffScaler", "metaclass_type": null, "metadata": {}, "module_name": "opennmt.optimizers.mixed_precision_wrapper", "mro": ["opennmt.optimizers.mixed_precision_wrapper.BackoffScaler", "builtins.object"], "names": {".class": "SymbolTable", "__init__": {".class": "SymbolTableNode", "kind": "Mdef", "node": {".class": "FuncDef", "arg_kinds": [0, 0], "arg_names": ["self", "params"], "flags": [], "fullname": "opennmt.optimizers.mixed_precision_wrapper.BackoffScaler.__init__", "name": "__init__", "type": null}}, "iteration": {".class": "SymbolTableNode", "implicit": true, "kind": "Mdef", "node": {".class": "Var", "flags": [], "fullname": "opennmt.optimizers.mixed_precision_wrapper.BackoffScaler.iteration", "name": "iteration", "type": {".class": "AnyType", "missing_import_name": null, "source_any": null, "type_of_any": 1}}}, "last_overflow_iteration": {".class": "SymbolTableNode", "implicit": true, "kind": "Mdef", "node": {".class": "Var", "flags": [], "fullname": "opennmt.optimizers.mixed_precision_wrapper.BackoffScaler.last_overflow_iteration", "name": "last_overflow_iteration", "type": {".class": "AnyType", "missing_import_name": null, "source_any": null, "type_of_any": 1}}}, "loss_scale": {".class": "SymbolTableNode", "kind": "Mdef", "node": {".class": "Decorator", "func": {".class": "FuncDef", "arg_kinds": [0], "arg_names": ["self"], "flags": ["is_property", "is_decorated"], "fullname": "opennmt.optimizers.mixed_precision_wrapper.BackoffScaler.loss_scale", "name": "loss_scale", "type": null}, "is_overload": false, "var": {".class": "Var", "flags": ["is_initialized_in_class", "is_property"], "fullname": null, "name": "loss_scale", "type": {".class": "CallableType", "arg_kinds": [0], "arg_names": ["self"], "arg_types": [{".class": "AnyType", "missing_import_name": null, "source_any": null, "type_of_any": 1}], "bound_args": [], "def_extras": {}, "fallback": "builtins.function", "implicit": true, "is_ellipsis_args": false, "name": "loss_scale of BackoffScaler", "ret_type": {".class": "AnyType", "missing_import_name": null, "source_any": null, "type_of_any": 1}, "variables": []}}}}, "scale": {".class": "SymbolTableNode", "implicit": true, "kind": "Mdef", "node": {".class": "Var", "flags": [], "fullname": "opennmt.optimizers.mixed_precision_wrapper.BackoffScaler.scale", "name": "scale", "type": {".class": "AnyType", "missing_import_name": null, "source_any": null, "type_of_any": 1}}}, "scale_max": {".class": "SymbolTableNode", "implicit": true, "kind": "Mdef", "node": {".class": "Var", "flags": [], "fullname": "opennmt.optimizers.mixed_precision_wrapper.BackoffScaler.scale_max", "name": "scale_max", "type": {".class": "AnyType", "missing_import_name": null, "source_any": null, "type_of_any": 1}}}, "scale_min": {".class": "SymbolTableNode", "implicit": true, "kind": "Mdef", "node": {".class": "Var", "flags": [], "fullname": "opennmt.optimizers.mixed_precision_wrapper.BackoffScaler.scale_min", "name": "scale_min", "type": {".class": "AnyType", "missing_import_name": null, "source_any": null, "type_of_any": 1}}}, "step_factor": {".class": "SymbolTableNode", "implicit": true, "kind": "Mdef", "node": {".class": "Var", "flags": [], "fullname": "opennmt.optimizers.mixed_precision_wrapper.BackoffScaler.step_factor", "name": "step_factor", "type": {".class": "AnyType", "missing_import_name": null, "source_any": null, "type_of_any": 1}}}, "step_window": {".class": "SymbolTableNode", "implicit": true, "kind": "Mdef", "node": {".class": "Var", "flags": [], "fullname": "opennmt.optimizers.mixed_precision_wrapper.BackoffScaler.step_window", "name": "step_window", "type": {".class": "AnyType", "missing_import_name": null, "source_any": null, "type_of_any": 1}}}, "update_op": {".class": "SymbolTableNode", "kind": "Mdef", "node": {".class": "FuncDef", "arg_kinds": [0, 0, 0], "arg_names": ["self", "has_nan", "amax"], "flags": [], "fullname": "opennmt.optimizers.mixed_precision_wrapper.BackoffScaler.update_op", "name": "update_op", "type": null}}}, "tuple_type": null, "type_vars": [], "typeddict_type": null}}, "LogMaxScaler": {".class": "SymbolTableNode", "kind": "Gdef", "node": {".class": "TypeInfo", "_promote": null, "abstract_attributes": [], "bases": ["builtins.object"], "declared_metaclass": null, "defn": {".class": "ClassDef", "fullname": "opennmt.optimizers.mixed_precision_wrapper.LogMaxScaler", "name": "LogMaxScaler", "type_vars": []}, "flags": [], "fullname": "opennmt.optimizers.mixed_precision_wrapper.LogMaxScaler", "metaclass_type": null, "metadata": {}, "module_name": "opennmt.optimizers.mixed_precision_wrapper", "mro": ["opennmt.optimizers.mixed_precision_wrapper.LogMaxScaler", "builtins.object"], "names": {".class": "SymbolTable", "__init__": {".class": "SymbolTableNode", "kind": "Mdef", "node": {".class": "FuncDef", "arg_kinds": [0, 0], "arg_names": ["self", "params"], "flags": [], "fullname": "opennmt.optimizers.mixed_precision_wrapper.LogMaxScaler.__init__", "name": "__init__", "type": null}}, "b1_correction": {".class": "SymbolTableNode", "implicit": true, "kind": "Mdef", "node": {".class": "Var", "flags": [], "fullname": "opennmt.optimizers.mixed_precision_wrapper.LogMaxScaler.b1_correction", "name": "b1_correction", "type": {".class": "AnyType", "missing_import_name": null, "source_any": null, "type_of_any": 1}}}, "b2_correction": {".class": "SymbolTableNode", "implicit": true, "kind": "Mdef", "node": {".class": "Var", "flags": [], "fullname": "opennmt.optimizers.mixed_precision_wrapper.LogMaxScaler.b2_correction", "name": "b2_correction", "type": {".class": "AnyType", "missing_import_name": null, "source_any": null, "type_of_any": 1}}}, "beta1": {".class": "SymbolTableNode", "implicit": true, "kind": "Mdef", "node": {".class": "Var", "flags": [], "fullname": "opennmt.optimizers.mixed_precision_wrapper.LogMaxScaler.beta1", "name": "beta1", "type": {".class": "AnyType", "missing_import_name": null, "source_any": null, "type_of_any": 1}}}, "beta2": {".class": "SymbolTableNode", "implicit": true, "kind": "Mdef", "node": {".class": "Var", "flags": [], "fullname": "opennmt.optimizers.mixed_precision_wrapper.LogMaxScaler.beta2", "name": "beta2", "type": {".class": "AnyType", "missing_import_name": null, "source_any": null, "type_of_any": 1}}}, "iteration": {".class": "SymbolTableNode", "implicit": true, "kind": "Mdef", "node": {".class": "Var", "flags": [], "fullname": "opennmt.optimizers.mixed_precision_wrapper.LogMaxScaler.iteration", "name": "iteration", "type": {".class": "AnyType", "missing_import_name": null, "source_any": null, "type_of_any": 1}}}, "log_max": {".class": "SymbolTableNode", "implicit": true, "kind": "Mdef", "node": {".class": "Var", "flags": [], "fullname": "opennmt.optimizers.mixed_precision_wrapper.LogMaxScaler.log_max", "name": "log_max", "type": {".class": "AnyType", "missing_import_name": null, "source_any": null, "type_of_any": 1}}}, "loss_scale": {".class": "SymbolTableNode", "kind": "Mdef", "node": {".class": "Decorator", "func": {".class": "FuncDef", "arg_kinds": [0], "arg_names": ["self"], "flags": ["is_property", "is_decorated"], "fullname": "opennmt.optimizers.mixed_precision_wrapper.LogMaxScaler.loss_scale", "name": "loss_scale", "type": null}, "is_overload": false, "var": {".class": "Var", "flags": ["is_initialized_in_class", "is_property"], "fullname": null, "name": "loss_scale", "type": {".class": "CallableType", "arg_kinds": [0], "arg_names": ["self"], "arg_types": [{".class": "AnyType", "missing_import_name": null, "source_any": null, "type_of_any": 1}], "bound_args": [], "def_extras": {}, "fallback": "builtins.function", "implicit": true, "is_ellipsis_args": false, "name": "loss_scale of LogMaxScaler", "ret_type": {".class": "AnyType", "missing_import_name": null, "source_any": null, "type_of_any": 1}, "variables": []}}}}, "overflow_std_dev": {".class": "SymbolTableNode", "implicit": true, "kind": "Mdef", "node": {".class": "Var", "flags": [], "fullname": "opennmt.optimizers.mixed_precision_wrapper.LogMaxScaler.overflow_std_dev", "name": "overflow_std_dev", "type": {".class": "AnyType", "missing_import_name": null, "source_any": null, "type_of_any": 1}}}, "scale": {".class": "SymbolTableNode", "implicit": true, "kind": "Mdef", "node": {".class": "Var", "flags": [], "fullname": "opennmt.optimizers.mixed_precision_wrapper.LogMaxScaler.scale", "name": "scale", "type": {".class": "AnyType", "missing_import_name": null, "source_any": null, "type_of_any": 1}}}, "scale_max": {".class": "SymbolTableNode", "implicit": true, "kind": "Mdef", "node": {".class": "Var", "flags": [], "fullname": "opennmt.optimizers.mixed_precision_wrapper.LogMaxScaler.scale_max", "name": "scale_max", "type": {".class": "AnyType", "missing_import_name": null, "source_any": null, "type_of_any": 1}}}, "scale_min": {".class": "SymbolTableNode", "implicit": true, "kind": "Mdef", "node": {".class": "Var", "flags": [], "fullname": "opennmt.optimizers.mixed_precision_wrapper.LogMaxScaler.scale_min", "name": "scale_min", "type": {".class": "AnyType", "missing_import_name": null, "source_any": null, "type_of_any": 1}}}, "slow_x_hat": {".class": "SymbolTableNode", "implicit": true, "kind": "Mdef", "node": {".class": "Var", "flags": [], "fullname": "opennmt.optimizers.mixed_precision_wrapper.LogMaxScaler.slow_x_hat", "name": "slow_x_hat", "type": {".class": "AnyType", "missing_import_name": null, "source_any": null, "type_of_any": 1}}}, "update_op": {".class": "SymbolTableNode", "kind": "Mdef", "node": {".class": "FuncDef", "arg_kinds": [0, 0, 0], "arg_names": ["self", "has_nan", "amax"], "flags": [], "fullname": "opennmt.optimizers.mixed_precision_wrapper.LogMaxScaler.update_op", "name": "update_op", "type": null}}, "x_hat": {".class": "SymbolTableNode", "implicit": true, "kind": "Mdef", "node": {".class": "Var", "flags": [], "fullname": "opennmt.optimizers.mixed_precision_wrapper.LogMaxScaler.x_hat", "name": "x_hat", "type": {".class": "AnyType", "missing_import_name": null, "source_any": null, "type_of_any": 1}}}, "xsquared_hat": {".class": "SymbolTableNode", "implicit": true, "kind": "Mdef", "node": {".class": "Var", "flags": [], "fullname": "opennmt.optimizers.mixed_precision_wrapper.LogMaxScaler.xsquared_hat", "name": "xsquared_hat", "type": {".class": "AnyType", "missing_import_name": null, "source_any": null, "type_of_any": 1}}}}, "tuple_type": null, "type_vars": [], "typeddict_type": null}}, "MixedPrecisionOptimizerWrapper": {".class": "SymbolTableNode", "kind": "Gdef", "node": {".class": "TypeInfo", "_promote": null, "abstract_attributes": [], "bases": ["builtins.object"], "declared_metaclass": null, "defn": {".class": "ClassDef", "fullname": "opennmt.optimizers.mixed_precision_wrapper.MixedPrecisionOptimizerWrapper", "name": "MixedPrecisionOptimizerWrapper", "type_vars": []}, "flags": ["fallback_to_any"], "fullname": "opennmt.optimizers.mixed_precision_wrapper.MixedPrecisionOptimizerWrapper", "metaclass_type": null, "metadata": {}, "module_name": "opennmt.optimizers.mixed_precision_wrapper", "mro": ["opennmt.optimizers.mixed_precision_wrapper.MixedPrecisionOptimizerWrapper", "builtins.object"], "names": {".class": "SymbolTable", "__init__": {".class": "SymbolTableNode", "kind": "Mdef", "node": {".class": "FuncDef", "arg_kinds": [0, 0, 1], "arg_names": ["self", "optimizer", "loss_scale"], "flags": [], "fullname": "opennmt.optimizers.mixed_precision_wrapper.MixedPrecisionOptimizerWrapper.__init__", "name": "__init__", "type": null}}, "_fp32_to_fp16": {".class": "SymbolTableNode", "implicit": true, "kind": "Mdef", "node": {".class": "Var", "flags": [], "fullname": "opennmt.optimizers.mixed_precision_wrapper.MixedPrecisionOptimizerWrapper._fp32_to_fp16", "name": "_fp32_to_fp16", "type": {".class": "AnyType", "missing_import_name": null, "source_any": null, "type_of_any": 1}}}, "_loss_scale": {".class": "SymbolTableNode", "implicit": true, "kind": "Mdef", "node": {".class": "Var", "flags": [], "fullname": "opennmt.optimizers.mixed_precision_wrapper.MixedPrecisionOptimizerWrapper._loss_scale", "name": "_loss_scale", "type": {".class": "AnyType", "missing_import_name": null, "source_any": null, "type_of_any": 1}}}, "_loss_scaler": {".class": "SymbolTableNode", "implicit": true, "kind": "Mdef", "node": {".class": "Var", "flags": [], "fullname": "opennmt.optimizers.mixed_precision_wrapper.MixedPrecisionOptimizerWrapper._loss_scaler", "name": "_loss_scaler", "type": {".class": "AnyType", "missing_import_name": null, "source_any": null, "type_of_any": 1}}}, "_optimizer": {".class": "SymbolTableNode", "implicit": true, "kind": "Mdef", "node": {".class": "Var", "flags": [], "fullname": "opennmt.optimizers.mixed_precision_wrapper.MixedPrecisionOptimizerWrapper._optimizer", "name": "_optimizer", "type": {".class": "AnyType", "missing_import_name": null, "source_any": null, "type_of_any": 1}}}, "apply_gradients": {".class": "SymbolTableNode", "kind": "Mdef", "node": {".class": "FuncDef", "arg_kinds": [0, 0, 1, 1], "arg_names": ["self", "grads_and_vars", "global_step", "name"], "flags": [], "fullname": "opennmt.optimizers.mixed_precision_wrapper.MixedPrecisionOptimizerWrapper.apply_gradients", "name": "apply_gradients", "type": null}}, "compute_gradients": {".class": "SymbolTableNode", "kind": "Mdef", "node": {".class": "FuncDef", "arg_kinds": [0, 0, 1, 1, 1, 1, 1], "arg_names": ["self", "loss", "var_list", "gate_gradients", "aggregation_method", "colocate_gradients_with_ops", "grad_loss"], "flags": [], "fullname": "opennmt.optimizers.mixed_precision_wrapper.MixedPrecisionOptimizerWrapper.compute_gradients", "name": "compute_gradients", "type": null}}}, "tuple_type": null, "type_vars": [], "typeddict_type": null}}, "__doc__": {".class": "SymbolTableNode", "kind": "Gdef", "node": {".class": "Var", "flags": [], "fullname": "opennmt.optimizers.mixed_precision_wrapper.__doc__", "name": "__doc__", "type": "builtins.str"}}, "__file__": {".class": "SymbolTableNode", "kind": "Gdef", "node": {".class": "Var", "flags": [], "fullname": "opennmt.optimizers.mixed_precision_wrapper.__file__", "name": "__file__", "type": "builtins.str"}}, "__name__": {".class": "SymbolTableNode", "kind": "Gdef", "node": {".class": "Var", "flags": [], "fullname": "opennmt.optimizers.mixed_precision_wrapper.__name__", "name": "__name__", "type": "builtins.str"}}, "__package__": {".class": "SymbolTableNode", "kind": "Gdef", "node": {".class": "Var", "flags": [], "fullname": "opennmt.optimizers.mixed_precision_wrapper.__package__", "name": "__package__", "type": "builtins.str"}}, "_scale_grads": {".class": "SymbolTableNode", "kind": "Gdef", "node": {".class": "FuncDef", "arg_kinds": [0, 0], "arg_names": ["grads_and_vars", "scale"], "flags": [], "fullname": "opennmt.optimizers.mixed_precision_wrapper._scale_grads", "name": "_scale_grads", "type": null}}, "get_loss_scale_from_params": {".class": "SymbolTableNode", "kind": "Gdef", "node": {".class": "FuncDef", "arg_kinds": [0], "arg_names": ["params"], "flags": [], "fullname": "opennmt.optimizers.mixed_precision_wrapper.get_loss_scale_from_params", "name": "get_loss_scale_from_params", "type": null}}, "six": {".class": "SymbolTableNode", "cross_ref": "six", "kind": "Gdef"}, "tf": {".class": "SymbolTableNode", "kind": "Gdef", "node": {".class": "Var", "flags": ["is_suppressed_import"], "fullname": "opennmt.optimizers.mixed_precision_wrapper.tf", "name": "tf", "type": {".class": "AnyType", "missing_import_name": "opennmt.optimizers.mixed_precision_wrapper.tf", "source_any": null, "type_of_any": 3}}}}, "path": "/Users/worko/OpenNMT-tf/opennmt/optimizers/mixed_precision_wrapper.py"}